{
	"api_query_meta_data": {
		"query_name": "Log4J Exploit Attempts on Web Servers",
		"query_id": "001",
		"api_query_description": "This API query is designed to detect Log4J Shell exploit signatures in the URLs and URL-agent strings within HTTP request messages sent inbound into our web application servers.  Our information sources are the following: Web Application Server Logs.",
		"search_type": "targeted_search",
		"selector_type": "query_syntax",
		"information_sources": "Web Application Server Logs",
		"api_platform": "elasticsearch"
	},
	"api_query_required_parameters": {
		"index": "*-web-*",
		"target_selector": "Not Applicable",
		"target_selector_query_type": "Not Applicable",
		"results_batching_size": "10000",
		"point-in-time_keep_alive": "10m"
	},
	"api_query_syntax_skeleton": {
		"size": "",
		"sort": [
			{
				"@timestamp": "asc"
			}
		],
		"pit": {
			"id": "",
			"keep_alive": ""
		},
		"track_total_hits": true,
		"query": {
			"filter": [],
			"should": [
				{"wildcard": {"url.original": "*jndi*"}},
				{"wildcard": {"user_agent.original": "*jndi*"}}
			],
			"minimum_should_match": 1,
			"must_not": [
				{"terms": {"source.ip": ["10.0.0.0/8", "172.16.0.0/12", "192.168.0.0/16"]}}
			]
		},
		"fields": [
			"@timestamp",
			"observer.product",
			"source.ip",
			"user_agent.original",
			"url.original",
			"event.action",
			"_id"
		],
		"_source": false
	}
}